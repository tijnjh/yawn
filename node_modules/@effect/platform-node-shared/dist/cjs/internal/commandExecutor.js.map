{"version":3,"file":"commandExecutor.js","names":["Command","_interopRequireWildcard","require","CommandExecutor","FileSystem","Deferred","Effect","_Function","Inspectable","Layer","Option","Sink","Stream","ChildProcess","_error","_sink","_stream","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","inputToStdioOption","stdin","outputToStdioOption","output","toError","err","globalThis","Error","String","toPlatformError","method","error","command","flattened","flatten","reduce","acc","curr","args","join","length","handleErrnoException","ProcessProto","ProcessTypeId","BaseProto","toJSON","_id","pid","runCommand","fileSystem","_tag","spawn","flatMap","make","exitCode","async","resume","handle","stdio","stdout","stderr","cwd","getOrElse","constUndefined","shell","env","process","fromEntries","detached","platform","on","fail","unsafeDone","succeed","sync","kill","killProcessGroup","_","exec","void","signal","try","catch","killProcess","suspend","pipe","match","onNone","onSome","dir","access","zipRight","acquireRelease","isDone","done","orElse","await","ignore","code","map","exitCodeDeferred","drain","fromWritable","ExitCode","isRunning","negate","asVoid","ProcessId","fromReadable","transduce","assign","create","identity","tap","forkDaemon","run","head","tail","slice","initial","last","stream","unwrapScoped","layer","exports","effect","makeExecutor"],"sources":["../../../src/internal/commandExecutor.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}