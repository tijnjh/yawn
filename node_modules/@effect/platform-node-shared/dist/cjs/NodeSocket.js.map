{"version":3,"file":"NodeSocket.js","names":["Socket","_interopRequireWildcard","require","Channel","Context","Deferred","Effect","FiberSet","_Function","Layer","Scope","Net","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","NetSocket","exports","GenericTag","makeNet","options","fromDuplex","scopeWith","scope","conn","flatMap","addFinalizer","sync","closed","destroySoon","destroy","async","resume","createConnection","once","succeed","on","cause","fail","SocketGenericError","reason","open","withFiberRuntime","fiber","currentSocket","latch","unsafeMakeLatch","openContext","currentContext","run","handler","opts","scopedWith","fnUntraced","fiberSet","make","pipe","extend","undefined","off","onData","onEnd","onError","onClose","openTimeout","timeoutFail","duration","onTimeout","Error","identity","provideService","runtime","onOpen","join","chunk","result","isEffect","unsafeDone","deferred","void","hadError","SocketCloseError","code","mapInputContext","input","merge","ensuring","unsafeClose","interruptible","write","whenOpen","isCloseEvent","writer","acquireRelease","writableEnded","end","of","TypeId","runRaw","makeNetChannel","unwrapScoped","map","toChannelWith","layerNet","effect"],"sources":["../../src/NodeSocket.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}