{"version":3,"file":"commandExecutor.js","names":["Command","CommandExecutor","FileSystem","Deferred","Effect","constUndefined","identity","pipe","Inspectable","Layer","Option","Sink","Stream","ChildProcess","handleErrnoException","fromWritable","fromReadable","inputToStdioOption","stdin","outputToStdioOption","output","toError","err","globalThis","Error","String","toPlatformError","method","error","command","flattened","flatten","reduce","acc","curr","args","join","length","ProcessProto","ProcessTypeId","BaseProto","toJSON","_id","pid","runCommand","fileSystem","_tag","spawn","flatMap","make","exitCode","async","resume","handle","stdio","stdout","stderr","cwd","getOrElse","shell","env","process","Object","fromEntries","detached","platform","on","fail","unsafeDone","succeed","sync","kill","killProcessGroup","_","exec","void","signal","try","catch","killProcess","suspend","match","onNone","onSome","dir","access","zipRight","acquireRelease","isDone","done","orElse","await","ignore","code","map","exitCodeDeferred","drain","ExitCode","isRunning","negate","asVoid","ProcessId","transduce","assign","create","tap","forkDaemon","run","head","tail","slice","initial","last","stream","unwrapScoped","layer","effect","makeExecutor"],"sources":["../../../src/internal/commandExecutor.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}