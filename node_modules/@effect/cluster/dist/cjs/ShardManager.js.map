{"version":3,"file":"ShardManager.js","names":["Rpc","_interopRequireWildcard","require","RpcClient","RpcGroup","RpcServer","Arr","Clock","Config_","ConfigProvider","Context","Data","Deferred","Duration","Effect","Equal","FiberSet","_Function","Iterable","Layer","Mailbox","Metric","MetricLabel","MutableHashMap","MutableHashSet","Option","PubSub","Queue","Schedule","Schema","_ClusterError","ClusterMetrics","_shardManager","MachineId","_Runner","_RunnerAddress","_RunnerHealth","_Runners","_ShardId","_ShardingConfig","_ShardStorage","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","ShardManager","Tag","exports","Config","defaults","rebalanceDebounce","seconds","rebalanceInterval","rebalanceRetryInterval","rebalanceRate","persistRetryCount","persistRetryInterval","runnerHealthCheckInterval","minutes","runnerPingTimeout","configConfig","all","duration","pipe","withDefault","withDescription","number","integer","configFromEnv","withConfigProvider","fromEnv","constantCase","layerConfig","config","succeed","layerConfigFromEnv","effect","map","env","ShardManagerClient","ShardingEventSchema","Union","TaggedStruct","address","RunnerAddress","shards","Array","ShardId","Rpcs","make","payload","runner","Runner","success","Tuple","error","RunnerNotRegistered","stream","Number","ShardingEvent","taggedEnum","makeClientLocal","gen","ShardingConfig","clock","groups","Set","empty","machineId","of","register","_","groupsToAdd","sync","group","add","shardsPerGroup","makeShardId","runnerAddress","unregister","void","notifyUnhealthyRunner","getAssignments","shardingEvents","fnUntraced","_address","mailbox","offer","StreamStarted","getTime","currentTimeMillis","makeClientRpc","client","spanPrefix","disableTracing","Register","version","serverVersion","orDie","Unregister","NotifyUnhealthyRunner","GetAssignments","tap","events","ShardingEvents","asMailbox","take","takeAll","unsafeOfferAll","mb","into","forkScoped","GetTime","layerClientLocal","layerClientRpc","scoped","provide","Protocol","clientProtocol","RpcClientProtocol","shardManagerAddress","storage","ShardStorage","runnersApi","Runners","runnerHealthApi","RunnerHealth","shardingConfig","state","State","fromStorage","scope","unbounded","updateRunnerMetrics","runners","unsafeUpdate","size","allRunners","updateShardMetrics","stats","shardStats","shardCount","perRunner","assignedShards","unassignedShards","unassigned","withRetry","retry","schedule","spaced","times","ignore","persistRunners","unsafeMakeSemaphore","withPermits","suspend","saveRunners","persistAssignments","saveAssignments","assignments","isAlive","logWarning","toString","updateShardsState","isSome","value","fail","addAssignments","logInfo","pretty","current","filter","addRunner","unsafeCurrentTimeMillis","publish","RunnerRegistered","forkIn","rebalance","unassignments","shard","equals","push","none","removeRunner","length","RunnerUnregistered","rebalancing","rebalanceDeferred","rebalanceFibers","withFiberRuntime","fiber","rebalanceLoop","unsafeMake","id","await","deferred","undefined","runRebalance","intoDeferred","identity","onExit","sleep","logDebug","changes","keys","groupAssignments","groupUnassignments","groupChanges","decideAssignmentsForShards","addAllNested","from","increment","rebalances","failedRunners","run","ping","timeout","catchAll","remove","awaitEmpty","failedUnassignments","matchEffect","onFailure","onSuccess","ShardsUnassigned","forEach","some","ShardsAssigned","wereFailures","discard","zipRight","withSpan","captureStackTrace","checkRunnerHealth","concurrency","addFinalizer","catchAllCause","cause","andThen","forever","queue","subscribe","isNone","isRegistered","onConnection","layer","layerServerHandlers","toLayer","shardManager","takeBetween","MAX_SAFE_INTEGER","flatMap","offerAll","layerServer"],"sources":["../../src/ShardManager.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}