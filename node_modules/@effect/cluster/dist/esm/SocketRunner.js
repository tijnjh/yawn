/**
 * @since 1.0.0
 */
import { SocketServer } from "@effect/platform/SocketServer";
import * as RpcServer from "@effect/rpc/RpcServer";
import * as Effect from "effect/Effect";
import * as Layer from "effect/Layer";
import * as RunnerServer from "./RunnerServer.js";
const withLogAddress = layer => Layer.effectDiscard(Effect.gen(function* () {
  const server = yield* SocketServer;
  const address = server.address._tag === "UnixAddress" ? server.address.path : `${server.address.hostname}:${server.address.port}`;
  yield* Effect.annotateLogs(Effect.logInfo(`Listening on: ${address}`), {
    package: "@effect/cluster",
    service: "Runner"
  });
})).pipe(Layer.provideMerge(layer));
/**
 * @since 1.0.0
 * @category Layers
 */
export const layer = /*#__PURE__*/RunnerServer.layerWithClients.pipe(withLogAddress, /*#__PURE__*/Layer.provide(/*#__PURE__*/Layer.fresh(RpcServer.layerProtocolSocketServer)));
/**
 * @since 1.0.0
 * @category Layers
 */
export const layerClientOnly = RunnerServer.layerClientOnly;
//# sourceMappingURL=SocketRunner.js.map