{"version":3,"file":"EventLog.js","names":["KeyValueStore","_interopRequireWildcard","require","Chunk","Context","Effect","FiberMap","FiberRef","_Function","Layer","Option","_Pipeable","Predicate","Queue","Redacted","Schema","_EventJournal","Reactivity","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","SchemaTypeId","exports","Symbol","for","isEventLogSchema","u","hasProperty","schema","groups","EventLog","HandlersTypeId","handlersProto","_Endpoints","identity","handle","tag","handler","makeHandlers","group","context","handlers","event","events","pipe","pipeArguments","arguments","options","assign","create","gen","result","isEffect","registry","Registry","add","scopedDiscard","provide","layer","groupCompaction","effect","log","registerCompaction","keys","fnUntraced","entries","write","writePayload","timestamp","payload","entry","Entry","id","makeEntryId","msecs","encode","payloadMsgPack","locally","currentContext","orDie","primaryKey","disableValidation","byPrimaryKey","Map","decodeUnknown","record","push","taggedPayloads","_tag","createdAtMillis","layerEventLog","groupReactivity","Array","isArray","registerReactivity","obj","Tag","sync","items","Identity","makeRandom","of","publicKey","crypto","randomUUID","privateKey","make","getRandomValues","Uint8Array","Struct","String","Uint8ArrayFromBase64","SchemaFromString","StringFromBase64Url","compose","parseJson","decodeString","s","decodeSync","encodeString","encodeSync","layerIdentityKvs","store","forSchema","current","key","isSome","value","journal","EventJournal","remotes","compactors","journalSemaphore","makeSemaphore","reactivity","reactivityKeys","runRemote","remote","startSequence","nextRemoteSequence","changes","takeAll","flatMap","writeFromRemote","remoteId","toReadonlyArray","compact","size","remoteEntries","unprocessed","brackets","uncompacted","uncompactedRemote","length","remoteEntry","compactor","compacted","currentEntries","j","nextRemoteEntry","map","_","undefined","conflicts","logDebug","decodePayload","decode","decodedConflicts","unsafeInvalidate","catchAllCause","annotateLogs","service","entryId","idString","withPermits","forever","fork","withRemoteUncommited","addFinalizer","ignore","takeBetween","Number","MAX_SAFE_INTEGER","zipRight","sleep","scoped","provideService","interruptible","writeHandler","tap","mapInputContext","merge","die","registerRemote","acquireRelease","run","remove","Set","delete","destroy","_schema","makeClient"],"sources":["../../src/EventLog.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}