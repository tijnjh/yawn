{"version":3,"file":"Sse.js","names":["Channel","Chunk","Data","Duration","Effect","Mailbox","hasProperty","makeChannel","options","events","make","bufferSize","pipe","map","mailbox","retry","parser","makeParser","event","_tag","push","input","awaitRead","void","emit","chunks","forEach","feed","toEmit","zipRight","offerAll","fail","error","cause","failCause","done","_","end","embedInput","toChannel","unwrap","withRetry","catchAll","Retry","is","sleep","duration","as","onParse","isFirstChunk","buffer","startingPosition","startingFieldLength","eventId","lastEventId","eventName","data","reset","undefined","chunk","hasBom","slice","BOM","length","position","discardTrailingNewline","lineLength","fieldLength","character","index","parseEventStreamLine","lineBuffer","id","noValue","field","step","valueLength","value","toString","includes","parseInt","Number","isNaN","millis","every","charCode","charCodeAt","RetryTypeId","Symbol","for","TaggedClass","u","encoder","write","replace","toMillis"],"sources":["../../src/Sse.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}